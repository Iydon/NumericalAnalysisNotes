\section{Root-finding problem}
\begin{theo}{Intermediate Value Theorem}
$f \in [a,b]$，$\forall k \in f([a,b])$，$\exists c\in [a,b]$，$s.t.\,f(c)=k$。
\end{theo}
\begin{python}
def Bisection(fun, a:float, b:float, max_step:int=128, ...
    eps:float=1e-6)->float:
    mid_last = a
    if fun(a)*fun(b) < 0:
        for i in range(0, max_step):
            mid = (a+b) / 2
            if abs(mid-mid_last)<eps or abs(fun(mid))<eps:
                print("Step: %d\nZero: %fc"%(i, mid))
                return mid
            else:
                if fun(mid)*fun(a)<0:
                    b = mid
                else:
                    a = mid
            mid_last = mid
        print('Bisection cannot be convergent within..
               the pre-set steps.')
\end{python}
\begin{theo}{}
$f\in C[a,b](continuous)$，根据如上算法，$P_i$为mid的序列。如果$\exists$ root P$\in[a,b]$，则有$\left|P_n-P\right|\leq\frac{b-a}{x^n}$。
\end{theo}
\begin{proof}
$\left|b_n-a_n\right|=\frac{b-a}{2^{n-1}}$，
\[
\left|P_n-P\right|\leq\frac{1}{2}(b_n-a_n)\,=\,\frac{b-a}{2^n}
\]
于是$P_n = P + o(2_{-n})$。
\end{proof}
\begin{defn}{Fixed-point Iteration}
对g(P)，如果$\forall x\in [a,b]$，如果$\exists$ P $s.t.$ g(P)=P，则称$P$为不动点（fixed point）。\\
如果$g(x)\in C[a,b]$并且$g([a,b])\subset[a,b]$，there exists at least one p$\in[a,b]$，$s.t.$ g(p)=p。
\end{defn}
\begin{theo}{不动点迭代根的存在唯一性定理}
$g(x)\in C[a,b]$，$g([a,b])\subset[a,b]$。$\forall x\in [a,b]$，都有$g'(x)\leq\kappa<1$。
\end{theo}
\begin{proof}\\
    存在性：
    \begin{equation*}
        \begin{cases}
          h(a) =&g(a)-a \geq 0 \\
          h(b) =&g(b)-b \leq 0
        \end{cases}
    \end{equation*}\par
    于是有$h(a)h(b)\leq 0$，则$\exists$ p，$s.t.$ h(p)=0。\\
    唯一性：\par
    假设存在两个根$P_1$，$P_2$，使得$P_1=g(P_1)$，$P_2=g(P_2)$，但是$P_1\neq P_2$。
    \begin{align*}
        \left|g(P_1)-g(P_2)\right| &= \left|g'(\xi)\right|\left| P_1-P_2|\right|,\quad \xi\in [P_1,P_2]. \\
        &\leq \kappa\left|P_1-P_2\right|, contradiction.
    \end{align*}
\end{proof}
\begin{theo}{不动点收敛的充分条件}
g$\in$C[a,b]，$g([a,b])\subset[a,b]$，$g'(x)$存在，并且$\left|g'(x)\right|\leq\kappa <1$。$\forall P_0\in[a,b]$，定义序列$P_i=g(P_{i-1}),\quad i=1,2,\cdots$，则$\lim_{n\rightarrow\infty}P_n=P$（P为不动点）。
\end{theo}
\begin{proof}
    \begin{align*}
        \abs{P_n-P_n} &= \abs{g(P_{n-1}-g(P))} \\
        &= \abs{g'(\xi_{n-1})}\abs{P_{n-1}-P} \\
        &\leq \kappa\abs{P_{n-1}-P} \\
        &\leq \cdots \leq \cdots \\
        &\leq \kappa^n\abs{P_0-P} \rightarrow 0.
    \end{align*}
\end{proof}\par
其中，寻找不动点的代码如下：
\begin{python}
def fixed_point(fun, start:float=0, max_step:int=128, ...
    eps:float=1e-6)->float:
    new_val = fun(start)
    for i in range(0, max_step):
        old_val = new_val
        new_val = fun(old_val)
        if -eps<old_val-new_val<eps:
            print(i)
            return new_val
\end{python}








